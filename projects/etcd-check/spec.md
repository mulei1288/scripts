# 脚本规范：etcd-check

## 基本信息

- **脚本名称**：`etcd-check.sh`
- **严格性级别**：简单
- **脚本类型**：可执行脚本
- **作者**：pengzhaozun
- **创建日期**：2025-12-19
- **版本**：v1.0.0

## 功能概述
我们作为 k8s 云厂商，我们希望在 etcd 集群部分节点不可用时，找出异常节点

核心流程：
- 通过 `kubectl get node -owide`获取所有 master 节点 ip、节点名称
- 通过 `curl <节点 ip>:2381/health`，看看是否存在异常节点，不健康的节点为异常节点
- 通过 etcdctl 命令查询每个节点的 key 的条数，比对 key 条数是否一致，不一致的节点为异常节点


## 使用场景

- 场景 1：etcd 集群部分节点不可用
- 场景 2：数据不一致或丢失
- 场景 3：etcd 集群脑裂

## 使用方法
```bash
./etcd-check.sh
```



